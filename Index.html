<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EvaCloudd Finance - Gerenciador de Gastos</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

        <link rel="stylesheet" href="styles.css">
</head>
<body>

    <header>
        <div class="header-bg-image" aria-hidden="true"></div>

        <div class="header-left">
            <div class="header-title">
                <h1>EvaCloudd Finance </h1>
                <p>Controle financeiro digital e integrado.</p>
            </div>
        </div>

        <div class="header-center">
            <div class="header-illustration"></div>
        </div>

        <div class="header-right">
            <div class="stats-card">
                <div class="stat-item receita">
                    <span class="stat-label">Receitas</span>
                    <div class="stat-value" id="totalReceitas">R$ 0,00</div>
                </div>
                <div class="stat-item despesa">
                    <span class="stat-label">Despesas</span>
                    <div class="stat-value" id="totalDespesas">R$ 0,00</div>
                </div>
                <div class="stat-item saldo">
                    <span class="stat-label">Saldo do M√™s</span>
                    <div class="stat-value" id="saldoMes">R$ 0,00</div>
                </div>
            </div>
            <div class="relatorios-container month-nav">
                <div style="display: flex; gap: 5px; flex-wrap: wrap; align-items: center; justify-content: flex-end;">
                    <button onclick="mostrarRelatorio(-1)" style="font-size: 0.85rem; padding: 8px 12px;">‚Üê M√™s Anterior</button>
                    <div id="mesReferencia" style="text-align: center; padding: 8px 12px; background: rgba(255,255,255,0.2); border-radius: 8px; font-weight: 600; font-size: 0.9rem; min-width: 150px;">
                        M√™s de Refer√™ncia
                    </div>
                    <button onclick="mostrarRelatorio(1)" style="font-size: 0.85rem; padding: 8px 12px;">Pr√≥ximo M√™s ‚Üí</button>
                </div>
                <div style="display: flex; gap: 5px; flex-wrap: wrap; justify-content: flex-end;">
                    <button onclick="mostrarRelatorio(0)" style="font-size: 0.85rem; padding: 8px 12px;">M√™s Atual</button>
                </div>
            </div>
        </div>
    </header>

    <main class="container">
        
        <section class="left-col">
            <div class="card">
                <form id="expenseForm">
                    <div class="row">
                        <div class="form-group">
                            <input type="date" id="date" required>
                        </div>
                        <div class="form-group">
                            <select id="type">
                                <option value="Receita">Receita</option>
                                <option value="Despesa">Despesa</option>
                            </select>
                        </div>
                    </div>

                    <div class="row">
                        <div class="form-group">
                            <input type="text" id="category" placeholder="Categoria (ex: Alimenta√ß√£o)" required>
                        </div>
                        <div class="form-group">
                            <input type="number" id="amount" placeholder="Valor (R$)" step="0.01" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <textarea id="obs" rows="2" placeholder="Observa√ß√£o (opcional)"></textarea>
                    </div>

                    <div class="btn-group">
                        <button type="submit" class="btn-add">Adicionar</button>
                        <button type="button" class="btn-clear" onclick="clearForm()">Limpar</button>
                    </div>
                    <div class="btn-group">
                        <button type="button" class="btn-export" onclick="exportCSV()">Exportar CSV</button>
                        <button type="button" class="btn-pdf" onclick="generatePDF()">Gerar PDF</button>
                    </div>
                </form>

                <div class="transaction-list" id="transactionListSimple">
                    </div>
            </div>
        </section>

        <section class="right-col" id="reportArea">
            <div class="card">
                <div style="display: flex; justify-content: center; gap: 8px; margin-bottom: 20px; flex-wrap: wrap;">
                    <button onclick="gerarPDFMes(-1)" class="btn-pdf" style="font-size: 0.8rem; padding: 6px 10px;">üìÑ PDF M√™s Anterior</button>
                    <button onclick="gerarPDFMes(0)" class="btn-pdf" style="font-size: 0.8rem; padding: 6px 10px;">üìÑ PDF M√™s Atual</button>
                    <button onclick="gerarPDFMes(1)" class="btn-pdf" style="font-size: 0.8rem; padding: 6px 10px;">üìÑ PDF Pr√≥ximo M√™s</button>
                </div>
                <div class="charts-area">
                    <div class="chart-box">
                        <h4 style="margin-bottom:15px; color:var(--primary-blue);">Saldo Mensal</h4>
                        <div class="chart-container">
                            <canvas id="lineChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-box">
                        <h4 style="margin-bottom:15px; color:var(--primary-blue);">Por Categoria</h4>
                        <div class="chart-container">
                            <canvas id="pieChart"></canvas>
                        </div>
                    </div>
                </div>

                <div class="summary-table-container">
                    <h4 style="margin-bottom:15px; color:#333; margin-top:20px;">Resumo Detalhado</h4>
                    <table id="summaryTable">
                        <thead>
                            <tr>
                                <th>Data</th>
                                <th>Categoria</th>
                                <th>Tipo</th>
                                <th>Valor</th>
                                <th>Obs</th>
                            </tr>
                        </thead>
                        <tbody>
                            </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Se√ß√£o de Faturas Parceladas -->
        <section class="full-col" style="grid-column: 1 / -1; margin-top: 25px;">
            <div class="card">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; flex-wrap: wrap; gap: 15px;">
                    <h3 style="color: var(--primary-blue); font-size: 1.3rem; font-weight: 700;">üí≥ Faturas Parceladas</h3>
                    <button onclick="toggleFaturaForm()" class="btn-add" style="flex: 0 1 auto;">
                        <i class="fas fa-plus"></i> Nova Fatura Parcelada
                    </button>
                </div>

                <!-- Formul√°rio de Fatura Parcelada (inicialmente oculto) -->
                <div id="faturaFormContainer" style="display: none; background: var(--bg-light); padding: 25px; border-radius: 16px; margin-bottom: 25px;">
                    <form id="faturaForm">
                        <div class="row">
                            <div class="form-group">
                                <label>Cart√£o</label>
                                <input type="text" id="faturaCartao" placeholder="Ex: Visa, Mastercard" required>
                            </div>
                            <div class="form-group">
                                <label>Banco</label>
                                <input type="text" id="faturaBanco" placeholder="Ex: Banco do Brasil, Ita√∫" required>
                            </div>
                        </div>

                        <div class="row">
                            <div class="form-group">
                                <label>Valor Total (R$)</label>
                                <input type="number" id="faturaValorTotal" step="0.01" placeholder="0.00" required>
                            </div>
                            <div class="form-group">
                                <label>N√∫mero de Parcelas</label>
                                <input type="number" id="faturaParcelas" min="1" max="60" placeholder="Ex: 12" required>
                            </div>
                        </div>

                        <div class="row">
                            <div class="form-group">
                                <label>Data da Primeira Parcela</label>
                                <input type="date" id="faturaDataInicio" required>
                            </div>
                            <div class="form-group">
                                <label>Data de Vencimento da Fatura</label>
                                <input type="date" id="faturaDataVencimento" required>
                                <small style="color: var(--text-light); font-size: 0.8rem; display: block; margin-top: 4px;">
                                    Data da √∫ltima parcela (calculada automaticamente)
                                </small>
                            </div>
                        </div>

                        <div class="row">
                            <div class="form-group">
                                <label>N√∫mero de Parcelas Pagas</label>
                                <input type="number" id="faturaParcelasPagas" min="0" placeholder="0" value="0" required>
                                <small style="color: var(--text-light); font-size: 0.8rem; display: block; margin-top: 4px;">
                                    Quantas parcelas j√° foram pagas?
                                </small>
                            </div>
                            <div class="form-group">
                                <label>Taxa de Juros do Banco (% ao m√™s)</label>
                                <input type="number" id="faturaTaxaJuros" step="0.01" placeholder="Ex: 2.5" value="2.5" required>
                            </div>
                        </div>

                        <div class="row">
                            <div class="form-group">
                                <label>Descri√ß√£o</label>
                                <input type="text" id="faturaDescricao" placeholder="Ex: Compra de eletrodom√©stico">
                            </div>
                        </div>

                        <div class="btn-group">
                            <button type="submit" class="btn-add">Salvar Fatura</button>
                            <button type="button" class="btn-clear" onclick="toggleFaturaForm()">Cancelar</button>
                        </div>
                    </form>
                </div>

                <!-- Filtros -->
                <div style="background: var(--bg-light); padding: 20px; border-radius: 16px; margin-bottom: 20px;">
                    <h4 style="margin-bottom: 15px; color: var(--primary-blue);">üîç Filtros</h4>
                    <div class="row">
                        <div class="form-group">
                            <label>Filtrar por Cart√£o</label>
                            <select id="filtroCartao" onchange="filtrarFaturas()">
                                <option value="">Todos os cart√µes</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Filtrar por Banco</label>
                            <select id="filtroBanco" onchange="filtrarFaturas()">
                                <option value="">Todos os bancos</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Filtrar por Parcelas Restantes</label>
                            <select id="filtroParcelas" onchange="filtrarFaturas()">
                                <option value="">Todas</option>
                                <option value="1-3">1 a 3 parcelas</option>
                                <option value="4-6">4 a 6 parcelas</option>
                                <option value="7-12">7 a 12 parcelas</option>
                                <option value="13+">Mais de 12 parcelas</option>
                            </select>
                        </div>
                    </div>
                    <button onclick="limparFiltros()" class="btn-clear" style="margin-top: 10px;">
                        <i class="fas fa-times"></i> Limpar Filtros
                    </button>
                </div>

                <!-- Tabela de Faturas -->
                <div class="summary-table-container">
                    <h4 style="margin-bottom:15px; color:#333;">Faturas Parceladas</h4>
                    <table id="faturasTable">
                        <thead>
                            <tr>
                                <th>Cart√£o</th>
                                <th>Banco</th>
                                <th>Valor Total</th>
                                <th>Parcelas</th>
                                <th>Parcelas Pagas</th>
                                <th>Parcelas Restantes</th>
                                <th>Valor da Parcela</th>
                                <th>Pr√≥ximo Vencimento</th>
                                <th>Data Final</th>
                                <th>Valor com Juros (Pr√≥ximo)</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="faturasTableBody">
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Se√ß√£o de Despesas Recorrentes -->
        <section class="full-col" style="grid-column: 1 / -1; margin-top: 25px;">
            <div class="card">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; flex-wrap: wrap; gap: 15px;">
                    <h3 style="color: var(--primary-blue); font-size: 1.3rem; font-weight: 700;">üîÑ Despesas Recorrentes</h3>
                    <button onclick="toggleDespesaRecorrenteForm()" class="btn-add" style="flex: 0 1 auto;">
                        <i class="fas fa-plus"></i> Nova Despesa Recorrente
                    </button>
                </div>

                <!-- Formul√°rio de Despesa Recorrente (inicialmente oculto) -->
                <div id="despesaRecorrenteFormContainer" style="display: none; background: var(--bg-light); padding: 25px; border-radius: 16px; margin-bottom: 25px;">
                    <form id="despesaRecorrenteForm">
                        <div class="row">
                            <div class="form-group">
                                <label>Descri√ß√£o</label>
                                <input type="text" id="despesaRecorrenteDescricao" placeholder="Ex: Aluguel, Netflix, Academia" required>
                            </div>
                            <div class="form-group">
                                <label>Categoria</label>
                                <input type="text" id="despesaRecorrenteCategoria" placeholder="Ex: Moradia, Assinatura" required>
                            </div>
                        </div>

                        <div class="row">
                            <div class="form-group">
                                <label>Valor Mensal (R$)</label>
                                <input type="number" id="despesaRecorrenteValor" step="0.01" placeholder="0.00" required>
                            </div>
                            <div class="form-group">
                                <label>Dia do M√™s</label>
                                <input type="number" id="despesaRecorrenteDia" min="1" max="31" placeholder="Ex: 5" required>
                                <small style="color: var(--text-light); font-size: 0.8rem; display: block; margin-top: 4px;">
                                    Dia em que a despesa √© contabilizada todo m√™s
                                </small>
                            </div>
                        </div>

                        <div class="row">
                            <div class="form-group">
                                <label>Data de In√≠cio</label>
                                <input type="date" id="despesaRecorrenteInicio" required>
                            </div>
                            <div class="form-group">
                                <label>Data de T√©rmino (Opcional)</label>
                                <input type="date" id="despesaRecorrenteTermino">
                                <small style="color: var(--text-light); font-size: 0.8rem; display: block; margin-top: 4px;">
                                    Deixe em branco para despesa permanente
                                </small>
                            </div>
                        </div>

                        <div class="row">
                            <div class="form-group">
                                <label>Observa√ß√£o (Opcional)</label>
                                <input type="text" id="despesaRecorrenteObs" placeholder="Ex: Conta de luz">
                            </div>
                        </div>

                        <div class="btn-group">
                            <button type="submit" class="btn-add">Salvar Despesa Recorrente</button>
                            <button type="button" class="btn-clear" onclick="toggleDespesaRecorrenteForm()">Cancelar</button>
                        </div>
                    </form>
                </div>

                <!-- Lista de Despesas Recorrentes -->
                <div class="summary-table-container">
                    <h4 style="margin-bottom:15px; color:#333;">Despesas Recorrentes</h4>
                    <table id="despesasRecorrentesTable">
                        <thead>
                            <tr>
                                <th>Descri√ß√£o</th>
                                <th>Categoria</th>
                                <th>Valor Mensal</th>
                                <th>Dia do M√™s</th>
                                <th>In√≠cio</th>
                                <th>T√©rmino</th>
                                <th>Status</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="despesasRecorrentesTableBody">
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

    </main>

    <footer>
        <p style="text-align: center;">
            EvaCloudd Finance ‚Ä¢ O seu ecossistema de controle financeiro
        </p>
    </footer>
         <script src="app.js"></script>
</body>
</html>
